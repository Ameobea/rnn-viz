<script lang="ts">
  import { RNNGraph } from '../rnn/graph';
  import NodeVizComp from './NodeVizComp.svelte';

  const serializedRNNGraph = JSON.parse(
    '{"inputLayer":{"neurons":[{"name":"input_0","activation":"linear","weights":[],"bias":0},{"name":"input_1","activation":"linear","weights":[],"bias":0}]},"cells":[{"outputNeurons":[{"weights":[{"weight":0.7099999785423279,"index":0},{"weight":1.840000033378601,"index":2},{"weight":1.600000023841858,"index":4},{"weight":0.5799999833106995,"index":5}],"bias":0.009999999776482582,"name":"layer_0_output_0","activation":{"type":"interpolatedAmeo","factor":0.6,"leakyness":1}},{"weights":[{"weight":0.009999999776482582,"index":1}],"bias":-0.009999999776482582,"name":"layer_0_output_1","activation":{"type":"interpolatedAmeo","factor":0.6,"leakyness":1}},{"weights":[{"weight":-1.0800000429153442,"index":1}],"bias":0.009999999776482582,"name":"layer_0_output_2","activation":{"type":"interpolatedAmeo","factor":0.6,"leakyness":1}}],"recurrentNeurons":[{"weights":[{"weight":0.47999998927116394,"index":1},{"weight":-0.2199999988079071,"index":3}],"bias":0.8899999856948853,"name":"layer_0_recurrent_0","activation":{"type":"interpolatedAmeo","factor":0.6,"leakyness":1}},{"weights":[{"weight":-0.5199999809265137,"index":2}],"bias":0.6499999761581421,"name":"layer_0_recurrent_1","activation":{"type":"interpolatedAmeo","factor":0.6,"leakyness":1}},{"weights":[{"weight":0.4300000071525574,"index":1},{"weight":-0.11999999731779099,"index":2}],"bias":-0.14000000059604645,"name":"layer_0_recurrent_2","activation":{"type":"interpolatedAmeo","factor":0.6,"leakyness":1}},{"weights":[{"weight":1.7300000190734863,"index":1}],"bias":0.009999999776482582,"name":"layer_0_recurrent_3","activation":{"type":"interpolatedAmeo","factor":0.6,"leakyness":1}}],"stateNeurons":[{"bias":3.0737807750701904,"name":"layer_0_state_0","activation":"linear","weights":[{"weight":1,"index":0}]},{"bias":-0.17111679911613464,"name":"layer_0_state_1","activation":"linear","weights":[{"weight":1,"index":1}]},{"bias":-3.0195133686065674,"name":"layer_0_state_2","activation":"linear","weights":[{"weight":1,"index":2}]},{"bias":-1.2963265180587769,"name":"layer_0_state_3","activation":"linear","weights":[{"weight":1,"index":3}]}],"outputDim":3},{"outputNeurons":[null,{"weights":[{"weight":1.2100000381469727,"index":0},{"weight":0.5099999904632568,"index":2},{"weight":1.3799999952316284,"index":3}],"bias":0.30000001192092896,"name":"layer_1_output_1","activation":{"type":"interpolatedAmeo","factor":0.6,"leakyness":1}},null,null],"recurrentNeurons":[{"weights":[{"weight":3.9600000381469727,"index":1}],"bias":0.009999999776482582,"name":"layer_1_recurrent_0","activation":{"type":"interpolatedAmeo","factor":0.6,"leakyness":1}},null],"stateNeurons":[{"bias":-0.16120284795761108,"name":"layer_1_state_0","activation":"linear","weights":[{"weight":1,"index":0}]}],"outputDim":4}],"postLayers":[{"neurons":[{"weights":[{"weight":1.4600000381469727,"index":1}],"bias":0,"name":"post_layer_output_0","activation":"linear"}],"outputDim":1}],"outputs":{"neurons":[{"name":"output_0","activation":"linear","weights":[{"weight":1,"index":0}],"bias":0}]}}'
  );
  const graph = RNNGraph.deserialize(serializedRNNGraph);
  console.log(graph);
  graph.setInputSequence([new Float32Array(graph.inputDim).fill(-1)]);
</script>

<NodeVizComp {graph} />
